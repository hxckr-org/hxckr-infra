{
  "$schema": "https://raw.githubusercontent.com/jetify-com/devbox/0.13.6/.schema/devbox.schema.json",
  "packages": [
    "docker",
    "docker-compose",
    "rustup",
    "soft-serve@0.7.6",
    "diesel-cli",
    "openssl",
    "pkg-config",
    "libiconv"
  ],
  "shell": {
    "init_hook": [
      "# Change the prompt color to blue when in the shell",
      "export PS1=\"\\[\\033[01;34m\\]\\u@\\h:\\w\\[\\033[00m\\]\\$ \"",
      "echo \"You are now in the devbox shell!\"",
      "",
      "# Load environment variables from .env file",
      "if [ -f ./.env ]; then",
      "  set -a",
      "  source ./.env",
      "  set +a",
      "else",
      "  echo \"Warning: .env file not found in the current directory\"",
      "fi",
      "",
      "mkdir -p \"$SOFT_SERVE_POSTGRES_DATA\"",
      "",
      "# Start PostgreSQL container",
      "docker run --rm -d \\",
      "  --name soft-serve-db \\",
      "  -e POSTGRES_USER=$SOFT_SERVE_POSTGRES_USER \\",
      "  -e POSTGRES_PASSWORD=$SOFT_SERVE_POSTGRES_PASSWORD \\",
      "  -e POSTGRES_DB=$SOFT_SERVE_POSTGRES_DB \\",
      "  -p $SOFT_SERVE_POSTGRES_PORT:5432 \\",
      "  -v ${SOFT_SERVE_POSTGRES_DATA}:/var/lib/postgresql/data \\",
      "  postgres:15-alpine",
      "",
      "if [ $? -eq 0 ]; then",
      "  echo \"PostgreSQL development database for Soft-Serve started successfully\"",
      "else",
      "  echo \"Failed to start PostgreSQL development database for Soft-Serve\"",
      "fi",
      "",
      "# Rust setup",
      "rustup default stable",
      "export PATH=\"$HOME/.cargo/bin:$PATH\"",
      "echo \"Rust is now available in the shell!\"",
      "",
      "# Soft-Serve database URL",
      "export SOFT_SERVE_DATABASE_URL=\"postgres://$SOFT_SERVE_POSTGRES_USER:$SOFT_SERVE_POSTGRES_PASSWORD@$SOFT_SERVE_POSTGRES_HOST:$SOFT_SERVE_POSTGRES_PORT/$SOFT_SERVE_POSTGRES_DB\"",
      "echo \"You can use this as your soft-serve database URL: $SOFT_SERVE_DATABASE_URL\"",
      "",
      "# Setup cleanup on exit",
      "cleanup() {",
      "  echo \"Stopping PostgreSQL container...\"",
      "  docker stop soft-serve-db >/dev/null 2>&1",
      "}",
      "trap cleanup EXIT"
    ]
  }
}
